<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hatırladığım Sen</title>
  <!-- Firebase SDK v8 -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-analytics.js"></script>
  <style>
    /* CSS kodunuz aynı kaldı */
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #f4f4f9;
      min-height: 100vh;
      color: #333;
    }
    .page {
      display: none;
      min-height: 100vh;
      width: 100%;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      position: relative;
      text-align: center;
    }
    /* ... Diğer CSS kuralları aynen kalacak ... */
  </style>
</head>
<body>
  <!-- Sayfa yapınız aynı kalacak -->
  <div id="page1" class="page active">
    <!-- İçerikler aynı -->
  </div>
  <!-- Diğer sayfalar... -->

  <script>
    // Firebase v8 Yapılandırması
    const firebaseConfig = {
      apiKey: "AIzaSyBh10LwOctzhTx5D1UZIci9SZ4HnKUKrpM",
      authDomain: "mezuniyetsitesitakip.firebaseapp.com",
      databaseURL: "https://mezuniyetsitesitakip-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "mezuniyetsitesitakip",
      storageBucket: "mezuniyetsitesitakip.appspot.com",
      messagingSenderId: "1624725648",
      appId: "1:1624725648:web:4b0c9c59f4c9149f5fa015",
      measurementId: "G-Z2W3NFHBKR"
    };

    // Firebase'i başlat
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    const auth = firebase.auth();
    const analytics = firebase.analytics();

    // Sayfa geçiş fonksiyonu
    function showPage(pageId) {
      console.log(`Sayfa değiştiriliyor: ${pageId}`);
      
      // Tüm sayfaları gizle
      document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
      });

      // Tüm sesleri durdur
      document.querySelectorAll('audio').forEach(audio => {
        audio.pause();
        audio.currentTime = 0;
      });

      // Tüm videoları durdur
      document.querySelectorAll('video').forEach(video => {
        video.pause();
        video.currentTime = 0;
      });

      // Yeni sayfayı göster
      const newPage = document.getElementById(pageId);
      if (newPage) {
        newPage.classList.add('active');

        // Yeni sayfanın sesini oynat
        const newAudio = newPage.querySelector('audio');
        if (newAudio) {
          newAudio.play().catch(error => {
            console.log('Ses oynatma hatası:', error);
          });
        }

        // Yeni sayfanın videosunu oynat
        const newVideo = newPage.querySelector('video');
        if (newVideo) {
          newVideo.play().catch(error => console.log('Video oynatma hatası:', error));
        }
      }

      // Özel sayfa ayarları
      if (pageId === 'page7') {
        const redButton = document.getElementById('redButton');
        if (redButton) {
          redButton.style.position = '';
          redButton.style.left = '';
          redButton.style.top = '';
        }
        const gameMessage = document.getElementById('gameMessage');
        if (gameMessage) {
          gameMessage.textContent = '';
        }
      }

      if (pageId === 'page8') {
        const userText = document.getElementById('userText');
        if (userText) {
          userText.textContent = '';
        }
      }
    }

    // DOM yüklendiğinde
    document.addEventListener('DOMContentLoaded', function() {
      // Anonim oturum açma
      auth.signInAnonymously()
        .then(() => console.log("Anonim giriş başarılı"))
        .catch(error => console.error("Anonim giriş hatası:", error));

      // İlk sayfanın sesini oynat
      const audio = document.getElementById('audio1');
      if (audio) {
        setTimeout(() => {
          audio.muted = false;
          audio.play().catch(e => {
            console.log("Otomatik oynatma engellendi, kullanıcı etkileşimi bekleniyor...");
            document.body.addEventListener('click', function() {
              audio.play().catch(e => console.log("Tıklama sonrası oynatma hatası:", e));
            }, { once: true });
          });
        }, 1000);
      }

      // Yazı yazma özelliği (page8)
      const submitText = document.getElementById('submitText');
      const userInput = document.getElementById('userInput');
      const userText = document.getElementById('userText');

      if (submitText && userInput && userText) {
        submitText.addEventListener('click', () => {
          const message = userInput.value.trim();
          if (message) {
            database.ref('messages').push({
              text: message,
              timestamp: firebase.database.ServerValue.TIMESTAMP,
              userId: auth.currentUser ? auth.currentUser.uid : 'anonymous'
            })
            .then(() => {
              userText.textContent = `Mesaj gönderildi: ${message}`;
              userInput.value = '';
            })
            .catch(error => {
              console.error('Mesaj kaydetme hatası:', error);
              userText.textContent = 'Mesaj kaydedilemedi, lütfen tekrar deneyin.';
            });
          } else {
            userText.textContent = 'Lütfen bir mesaj yazın.';
          }
        });
      }

      // Kırmızı buton hareketi
      const redButton = document.getElementById('redButton');
      const blueButton = document.getElementById('blueButton');
      const gameMessage = document.getElementById('gameMessage');

      const blueMessages = [
        'Yeni başlangıçlar seni bekliyor! Mezuniyetinle her şey mümkün.',
        'Geleceğe cesur adımlar at, her an yeni bir fırsat!',
        'Hayallerin peşinden koş, bu sadece bir başlangıç!',
        'Dünya seninle daha güzel, ilerle ve parlamaya devam et!'
      ];

      if (redButton && blueButton) {
        const getSafePosition = () => {
          const container = redButton.parentElement.parentElement;
          const blueRect = blueButton.getBoundingClientRect();
          const containerRect = container.getBoundingClientRect();
          const buffer = 30;

          let newX, newY;
          let attempts = 0;
          const maxAttempts = 10;

          do {
            newX = Math.random() * (containerRect.width - redButton.offsetWidth - 20);
            newY = Math.random() * (containerRect.height - redButton.offsetHeight - 20);
            attempts++;
          } while (
            attempts < maxAttempts &&
            newX >= blueRect.left - containerRect.left - buffer &&
            newX <= blueRect.right - containerRect.left + buffer &&
            newY >= blueRect.top - containerRect.top - buffer &&
            newY <= blueRect.bottom - containerRect.top + buffer
          );

          if (attempts >= maxAttempts) {
            newX = blueRect.left - containerRect.left < containerRect.width / 2
              ? blueRect.right - containerRect.left + buffer
              : blueRect.left - containerRect.left - redButton.offsetWidth - buffer;
            newY = blueRect.top - containerRect.top + buffer;
          }

          return { x: newX, y: newY };
        };

        const moveRedButton = () => {
          const { x, y } = getSafePosition();
          redButton.style.position = 'absolute';
          redButton.style.left = `${x}px`;
          redButton.style.top = `${y}px`;
          if (gameMessage) {
            gameMessage.textContent = 'Kırmızı buton biraz inatçı gibi değil mi ? sen boşa vakit kaybetme maviye bas konuştuğun kişiye yaz';
          }
        };

        redButton.addEventListener('mouseover', moveRedButton);
        redButton.addEventListener('touchstart', (e) => {
          e.preventDefault();
          moveRedButton();
        });
      }

      if (blueButton && gameMessage) {
        blueButton.addEventListener('click', () => {
          const randomMessage = blueMessages[Math.floor(Math.random() * blueMessages.length)];
          gameMessage.textContent = randomMessage;
        });
      }
    });
  </script>
</body>
</html>
